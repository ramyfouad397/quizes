<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Transfusion Medicine - Learn by Quizzes</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f4f6fa;
      color: #222;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    header {
      background: linear-gradient(135deg, #0066cc, #00cc99);
      color: white;
      padding: 20px;
    }

    h1 {
      margin: 0;
      font-size: 2.5rem;
    }

    h2 {
      margin: 5px 0 0;
      font-weight: 400;
      font-size: 1.2rem;
      opacity: 0.9;
    }

    .container {
      margin: 20px auto;
      width: 90%;
      max-width: 900px;
    }

    .quiz-list, .question-block {
      margin-top: 20px;
    }

    .quiz-button {
      display: block;
      width: 100%;
      background: #3498db;
      color: white;
      border: none;
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      position: relative;
    }

    .quiz-button .progress {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      background: #27ae60;
      border-radius: 8px 0 0 8px;
      z-index: 0;
    }

    .quiz-button span {
      position: relative;
      z-index: 1;
    }

    .question {
      font-size: 1.2rem;
      margin: 15px 0;
    }

    .option {
      display: block;
      background: #ecf0f1;
      border: 2px solid transparent;
      padding: 12px;
      margin: 8px 0;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
    }

    .option.correct {
      background: #2ecc71;
      color: white;
    }

    .option.wrong {
      background: #e74c3c;
      color: white;
    }

    .option.disabled {
      pointer-events: none;
      opacity: 0.7;
    }

    .explanation {
      margin-top: 10px;
      font-size: 0.95rem;
      color: #555;
    }

    .restart-btn {
      margin-top: 20px;
      padding: 10px 20px;
      background: #8e44ad;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <h1>Transfusion Medicine</h1>
    <h2>Learn by Quizzes</h2>
  </header>

  <div class="container">
    <div id="quizList" class="quiz-list"></div>
    <div id="quizContainer"></div>
  </div>

  <script>
    // Example JSON data (you can replace with external file if needed)
    const quizData = {
      "quizzes": [
        {
          "name": "Iron Deficiency Anemia",
          "questions": [
            {
              "question": "What is the most common cause of iron deficiency anemia worldwide?",
              "options": ["Poor dietary intake", "Hookworm infection", "Chronic blood loss", "Celiac disease"],
              "answer": "Hookworm infection",
              "explanation": "Globally, hookworm infection is the leading cause of iron deficiency anemia due to chronic intestinal blood loss."
            },
            {
              "question": "Which laboratory finding is most consistent with iron deficiency anemia?",
              "options": ["High ferritin", "Low serum iron", "Normal TIBC", "Macrocytosis"],
              "answer": "Low serum iron",
              "explanation": "Iron deficiency anemia shows low serum iron, low ferritin, and increased TIBC."
            }
          ]
        },
        {
          "name": "Hereditary Spherocytosis",
          "questions": [
            {
              "question": "What is the genetic basis of hereditary spherocytosis?",
              "options": ["Enzyme deficiency", "Membrane protein defect", "Hemoglobin mutation", "Autoantibody destruction"],
              "answer": "Membrane protein defect",
              "explanation": "It is due to defects in RBC membrane proteins like ankyrin, spectrin, band 3."
            }
          ]
        }
      ]
    };

    const quizListDiv = document.getElementById("quizList");
    const quizContainer = document.getElementById("quizContainer");

    let currentQuiz = null;

    // Load quiz list
    function loadQuizList() {
      quizListDiv.innerHTML = "";
      quizData.quizzes.forEach((quiz, index) => {
        const btn = document.createElement("button");
        btn.classList.add("quiz-button");

        // Progress tracking
        let score = localStorage.getItem("quiz_" + quiz.name);
        let percentage = score ? parseInt(score) : null;

        if (percentage !== null) {
          const progress = document.createElement("div");
          progress.classList.add("progress");
          progress.style.width = percentage + "%";
          btn.appendChild(progress);
        }

        const span = document.createElement("span");
        span.innerText = quiz.name + (percentage !== null ? ` (${percentage}%)` : "");
        btn.appendChild(span);

        btn.onclick = () => loadQuiz(index);
        quizListDiv.appendChild(btn);
      });
    }

    // Load selected quiz
    function loadQuiz(index) {
      currentQuiz = quizData.quizzes[index];
      quizContainer.innerHTML = "";
      let score = 0;

      currentQuiz.questions.forEach((q, qi) => {
        const qDiv = document.createElement("div");
        qDiv.classList.add("question-block");

        const questionEl = document.createElement("div");
        questionEl.classList.add("question");
        questionEl.innerText = q.question;
        qDiv.appendChild(questionEl);

        q.options.forEach(opt => {
          const optBtn = document.createElement("div");
          optBtn.classList.add("option");
          optBtn.innerText = opt;
          optBtn.onclick = () => {
            // Disable all
            const allOptions = qDiv.querySelectorAll(".option");
            allOptions.forEach(o => o.classList.add("disabled"));

            if (opt === q.answer) {
              optBtn.classList.add("correct");
              score++;
            } else {
              optBtn.classList.add("wrong");
              // highlight correct
              allOptions.forEach(o => {
                if (o.innerText === q.answer) {
                  o.classList.add("correct");
                }
              });
            }

            const exp = document.createElement("div");
            exp.classList.add("explanation");
            exp.innerText = "Explanation: " + q.explanation;
            qDiv.appendChild(exp);
          };
          qDiv.appendChild(optBtn);
        });

        quizContainer.appendChild(qDiv);
      });

      const restartBtn = document.createElement("button");
      restartBtn.classList.add("restart-btn");
      restartBtn.innerText = "Submit & Save Progress";
      restartBtn.onclick = () => {
        let percentage = Math.round((score / currentQuiz.questions.length) * 100);
        localStorage.setItem("quiz_" + currentQuiz.name, percentage);
        loadQuizList();
        quizContainer.innerHTML = `<h3>Your Score: ${percentage}%</h3>`;
      };
      quizContainer.appendChild(restartBtn);
    }

    loadQuizList();
  </script>
</body>
</html>
